# ===================================
# PORT SCANNING DETECTION RULES
# Total: 17 rules (SID 1000001-1000017)
# ===================================

# TCP SYN Scan Detection (Multiple ports from single source)
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN TCP SYN Scan Detected"; flags:S,12; threshold: type threshold, track by_src, count 5, seconds 60; classtype:attempted-recon; sid:1000001; rev:1;)

# TCP Connect Scan Detection
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN TCP Connect Scan Detected"; flags:S,12; threshold: type threshold, track by_src, count 20, seconds 60; classtype:attempted-recon; sid:1000002; rev:1;)

# TCP FIN Scan Detection
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN TCP FIN Scan Detected"; flags:F,12; threshold: type threshold, track by_src, count 5, seconds 60; classtype:attempted-recon; sid:1000003; rev:1;)

# TCP NULL Scan Detection
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN TCP NULL Scan Detected"; flags:0; threshold: type threshold, track by_src, count 5, seconds 60; classtype:attempted-recon; sid:1000004; rev:1;)

# TCP XMAS Scan Detection
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN TCP XMAS Scan Detected"; flags:FPU,12; threshold: type threshold, track by_src, count 5, seconds 60; classtype:attempted-recon; sid:1000005; rev:1;)

# UDP Scan Detection
alert udp any any -> $HOME_NET any (msg:"PORTSCAN UDP Scan Detected"; threshold: type threshold, track by_src, count 20, seconds 60; classtype:attempted-recon; sid:1000006; rev:1;)

# ICMP Sweep Detection
alert icmp any any -> $HOME_NET any (msg:"PORTSCAN ICMP Sweep/Ping Scan Detected"; itype:8; threshold: type threshold, track by_src, count 5, seconds 60; classtype:attempted-recon; sid:1000007; rev:1;)

# Nmap User-Agent Detection
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN Nmap User-Agent Detected"; flow:established,to_server; content:"Nmap"; http_user_agent; nocase; classtype:attempted-recon; sid:1000008; rev:1;)

# Nmap Scripting Engine Detection
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN Nmap NSE Script Activity"; flow:established; content:"Nmap"; nocase; classtype:attempted-recon; sid:1000009; rev:1;)

# Masscan Detection
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN Masscan Activity Detected"; flags:S; window:1024; threshold: type threshold, track by_src, count 50, seconds 10; classtype:attempted-recon; sid:1000010; rev:1;)

# Rapid Port Connection Attempts
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN Rapid Port Connection Attempts"; flags:S; threshold: type threshold, track by_src, count 30, seconds 30; classtype:attempted-recon; sid:1000011; rev:1;)

# Horizontal Port Scan (Same port, multiple hosts)
alert tcp any any -> $HOME_NET 22 (msg:"PORTSCAN Horizontal Scan on SSH Port"; flags:S; threshold: type threshold, track by_src, count 5, seconds 60; classtype:attempted-recon; sid:1000012; rev:1;)

# Horizontal Port Scan (HTTP)
alert tcp any any -> $HOME_NET 80 (msg:"PORTSCAN Horizontal Scan on HTTP Port"; flags:S; threshold: type threshold, track by_src, count 5, seconds 60; classtype:attempted-recon; sid:1000013; rev:1;)

# Network Sweep Detection
alert icmp any any -> $HOME_NET any (msg:"PORTSCAN Network Sweep Activity"; itype:8; threshold: type threshold, track by_src, count 20, seconds 120; classtype:attempted-recon; sid:1000014; rev:1;)

# Sequential Port Scan
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN Sequential Port Scan"; flags:S; threshold: type threshold, track by_src, count 15, seconds 45; classtype:attempted-recon; sid:1000015; rev:1;)

# Distributed Port Scan (Multiple sources to single target)
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN Distributed Scan Detected"; flags:S; threshold: type threshold, track by_dst, count 30, seconds 60; classtype:attempted-recon; sid:1000016; rev:1;)

# ACK Scan Detection
alert tcp any any -> $HOME_NET any (msg:"PORTSCAN TCP ACK Scan Detected"; flags:A; threshold: type threshold, track by_src, count 15, seconds 60; classtype:attempted-recon; sid:1000017; rev:1;)
